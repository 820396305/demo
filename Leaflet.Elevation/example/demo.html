<!DOCTYPE html>
<html>
<head>
	<title>Leaflet.Elevation</title>
	<meta name="viewport" content="initial-scale=1.0, user-scalable=no" />
	 <style>
	   html, body, #map {
	      height:100%;
	      width:100%;
	      padding:0px;
	      margin:0px;
	   }
	</style>
	<script src="http://d3js.org/d3.v3.min.js" charset="utf-8"></script>
	<link rel="stylesheet" href="http://cdn.leafletjs.com/leaflet-0.7.2/leaflet.css" />
	<!--[if lte IE 8]><link rel="stylesheet" href="http://cdn.leafletjs.com/leaflet-0.7.2/leaflet.ie.css" /><![endif]-->


	<script type="text/javascript" src="http://cdn.leafletjs.com/leaflet-0.7.2/leaflet.js"></script>
	<script type="text/javascript" src="./lib/leaflet-gpx/gpx.js"></script>
</head>
<body>
	<input type="file" id="file-gpx">
	<div id="map"></div>

	<script type="text/javascript">
		var map = L.map('map',{zoomControl:false,fullscreenControl: true}).setView([23.2205056, 113.4585472], 17 );

		var url = 'http://7xjwvr.com1.z0.glb.clouddn.com/google/{z}/{x}/{y}.jpeg';
		L.tileLayer(url, {maxZoom: 19}).addTo(map);
		var map_gpx = null;
		document.getElementById('file-gpx').onchange = function(){
			if(this.files.length){
                var reader = new FileReader();
                reader.onload = function(){
                    try{
                        map_gpx = new L.GPX(reader.result, {
							async: true,
							marker_options: {
							    startIconUrl: '/theme/default/static/point_start.png',
							    endIconUrl:'/theme/default/static/point_end.png',
							    shadowUr:'',
							    iconSize:[30,50],
		    					iconAnchor:[15,49],
		    					shadowSize:[0,0]
						  	}
						});
						map_gpx.on('loaded', function(e) {
							alert('yes')
							console.log(e);
						  	map.fitBounds(e.target.getBounds());
						});
						map_gpx.on("addline",function(e){
							//el.addData(e.line);
						});
						map_gpx.addTo(map);
						console.log(map_gpx);


                    }catch(e){
                        alert('请选择标准gpx文件');
                    }
                };
               reader.readAsText(this.files[0]);
		}
	}
			
		





	</script>
</body>
</html>
